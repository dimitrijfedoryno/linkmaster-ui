version: '3.8'

services:
  backend:
    container_name: media-downloader-backend
    build:
      context: . # Root of the project, where server/Dockerfile is located
      dockerfile: server/Dockerfile
    restart: unless-stopped
    ports:
      - "5000:5000" # Exposes backend to the host network so frontend can access it
    environment:
      - PORT=5000
      - DOWNLOAD_PATH_VIDEO=/storage/video
      - DOWNLOAD_PATH_AUDIO=/storage/audio
      # Add your Spotify keys here if needed
      - SPOTIFY_CLIENT_ID=${SPOTIFY_CLIENT_ID}
      - SPOTIFY_CLIENT_SECRET=${SPOTIFY_CLIENT_SECRET}
    volumes:
      # Map Host paths to Container paths
      - /srv/dev-disk-by-uuid-1cfc3f1a-e64c-4b80-8151-d8f58a25e10f/Surikata/Multimedia/Videa:/storage/video
      - /srv/dev-disk-by-uuid-1cfc3f1a-e64c-4b80-8151-d8f58a25e10f/Surikata/Multimedia/Hudba:/storage/audio
      # Config volume for potential logs or persistent data
      - ./server/config:/app/config

  frontend:
    container_name: media-downloader-frontend
    build:
      context: . # Root of the project, where Dockerfile is located
      dockerfile: Dockerfile
    restart: unless-stopped
    ports:
      - "8090:80"
    depends_on:
      - backend
